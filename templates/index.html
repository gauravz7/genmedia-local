<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veo Prompt Generator</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body data-bs-theme="dark">
    <div id="loading-overlay">
        <div class="spinner"></div>
    </div>
    <div class="container mt-5">
        <div class="header">
            <h1>Veo AI Prompt Engineering</h1>
            <div class="theme-switch-wrapper">
                <label class="theme-switch" for="checkbox">
                    <input type="checkbox" id="checkbox" />
                    <div class="slider round"></div>
                </label>
            </div>
        </div>

        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="prompt-tab" data-bs-toggle="tab" data-bs-target="#prompt-generator" type="button" role="tab" aria-controls="prompt-generator" aria-selected="true">Prompt Generator</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="video-tab" data-bs-toggle="tab" data-bs-target="#video-generation" type="button" role="tab" aria-controls="video-generation" aria-selected="false">Video Generation</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="history-tab" data-bs-toggle="tab" data-bs-target="#prompt-history" type="button" role="tab" aria-controls="prompt-history" aria-selected="false">Prompt History</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="image-video-tab" data-bs-toggle="tab" data-bs-target="#image-video-generator" type="button" role="tab" aria-controls="image-video-generator" aria-selected="false">Image to Video</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="editor-tab" data-bs-toggle="tab" data-bs-target="#image-editor" type="button" role="tab" aria-controls="image-editor" aria-selected="false">Image Editor</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="settings-tab" data-bs-toggle="tab" data-bs-target="#settings" type="button" role="tab" aria-controls="settings" aria-selected="false">Settings</button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
            <!-- Prompt Generator Tab -->
            <div class="tab-pane fade show active" id="prompt-generator" role="tabpanel" aria-labelledby="prompt-tab">
                <div class="row mt-4">
                    <div class="col-md-6">
                        <h3>User Prompt</h3>
                        <textarea id="user-prompt" class="form-control" rows="10" placeholder="e.g., A majestic lion roaring on a rocky outcrop at sunset."></textarea>
                        <div class="form-group mt-2">
                            <label for="prompt-image-upload" class="form-label">Upload Image (Optional)</label>
                            <input type="file" class="form-control" id="prompt-image-upload" accept="image/*">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h3>System Instructions</h3>
                        <div class="input-group mb-3">
                            <select id="system-instruction-select" class="form-select">
                                <option selected>Load a saved instruction...</option>
                            </select>
                            <button id="delete-instruction-btn" class="btn btn-outline-danger" type="button">Delete</button>
                        </div>
                        <textarea id="system-instructions" class="form-control" rows="8">
YAML:
-
  metadata:
    prompt_name: "Scene 1"
    base_style: "Cinematic, 4K, realistic"
    aspect_ratio: "16:9"
    scene_description: "A [adjective] [location] at [time of day]."
    camera_setup: "[camera angle], [lens type]."
    camera_movement: "[camera movement description]."
    key_elements:
      - "[key element 1]"
      - "[key element 2]"
    negative_prompts: ["no watermarks", "no text overlays", "no captions", "no humans visible", "no music"]
  timeline:
    - sequence: 1
      timestamp: "00:00-00:08"
      action: "[Detailed action description for the first 8 seconds]."
      voice: "[Voiceover or dialogue for this sequence]."
      audio: "[Audio description for this sequence]."
-
  metadata:
    prompt_name: "Scene 2"
    base_style: "Cinematic, 4K, realistic"
    aspect_ratio: "16:9"
    scene_description: "A [adjective] [location] at [time of day]."
    camera_setup: "[camera angle], [lens type]."
    camera_movement: "[camera movement description]."
    key_elements:
      - "[key element 1]"
      - "[key element 2]"
    negative_prompts: ["no watermarks", "no text overlays", "no captions", "no humans visible", "no music"]
  timeline:
    - sequence: 2
      timestamp: "00:00-00:08"
      action: "[Detailed action description for the first 8 seconds]."
      voice: "[Voiceover or dialogue for this sequence]."
      audio: "[Audio description for this sequence]."
</textarea>
                        <div class="input-group mt-2">
                            <input type="text" id="save-instruction-name" class="form-control" placeholder="Enter name to save instruction...">
                            <button id="save-instruction-btn" class="btn btn-outline-secondary" type="button">Save</button>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-3">
                    <button id="generate-prompt-btn" class="btn btn-primary">Generate Final Prompt</button>
                </div>
                <div class="mt-4">
                    <h3>Final Generated Prompt</h3>
                    <textarea id="final-prompt" class="form-control" rows="5"></textarea>
                    <div id="refine-controls" class="mt-2" style="display: none;">
                        <input type="text" id="refine-instruction" class="form-control" placeholder="Enter refinement instruction (e.g., 'make it more dramatic')">
                        <button id="refine-prompt-btn" class="btn btn-info mt-2">Refine with AI</button>
                    </div>
                    <button id="add-to-video-generation-btn" class="btn btn-primary mt-2">Add to Video Generation Queue</button>
                </div>
            </div>

            <!-- Video Generation Tab -->
            <div class="tab-pane fade" id="video-generation" role="tabpanel" aria-labelledby="video-tab">
                <div class="mt-4">
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label for="video-model-select" class="form-label">Select Video Model</label>
                            <select class="form-select" id="video-model-select">
                                <option value="veo-3.0-fast-generate-001" selected>Veo 3.0 Fast</option>
                                <option value="veo-3.0-generate-001">Veo 3.0 Standard</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="seed-input" class="form-label">Enter Seed</label>
                            <input type="number" class="form-control" id="seed-input" value="42">
                        </div>
                        <div class="col-md-4">
                            <label for="video-aspect-ratio" class="form-label">Aspect Ratio</label>
                            <select class="form-select" id="video-aspect-ratio">
                                <option value="16:9" selected>16:9 (Landscape)</option>
                                <option value="9:16">9:16 (Portrait)</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group mb-3">
                        <label for="video-negative-prompt" class="form-label">Negative Prompt (Optional)</label>
                        <textarea id="video-negative-prompt" class="form-control" rows="2" placeholder="e.g., low quality, blurry"></textarea>
                    </div>
                    <h3>Prompts for Video Generation</h3>
                    <div id="prompt-queue" class="list-group">
                        <!-- Prompts will be added here dynamically -->
                    </div>
                    <div class="text-center mt-3">
                        <button id="run-parallel-generation-btn" class="btn btn-success">Run Parallel Generation</button>
                    </div>
                    <div id="video-status-container" class="mt-4">
                        <!-- Video generation statuses will appear here -->
                    </div>
                </div>
            </div>

            <!-- Generation History Tab -->
            <div class="tab-pane fade" id="prompt-history" role="tabpanel" aria-labelledby="history-tab">
                <div class="mt-4">
                    <h3>Generation History</h3>
                    <div id="history-list" class="accordion">
                        <!-- History will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Image to Video Tab -->
            <div class="tab-pane fade" id="image-video-generator" role="tabpanel" aria-labelledby="image-video-tab">
                <div class="mt-4">
                    <div class="row">
                        <div class="col-md-4">
                            <h3>1. Select Image & Options</h3>
                            <div class="form-group mb-2">
                                <label for="image-upload">Image File:</label>
                                <input class="form-control" type="file" id="image-upload" accept="image/*">
                                <div id="image-preview-container" class="mt-2" style="display: none;">
                                    <img id="image-preview" src="" alt="Image preview" class="img-fluid rounded">
                                </div>
                            </div>
                            <div class="form-group mb-2">
                                <label for="image-animation-prompt">Animation Prompt:</label>
                                <textarea id="image-animation-prompt" class="form-control" rows="3" placeholder="e.g., A gentle breeze rustles the leaves." disabled></textarea>
                            </div>
                            <div class="form-group mb-2">
                                <label for="image-negative-prompt">Negative Prompt (Optional):</label>
                                <textarea id="image-negative-prompt" class="form-control" rows="2" placeholder="e.g., low quality, blurry" disabled></textarea>
                            </div>
                            <div class="form-group mb-2">
                                <label for="image-aspect-ratio">Aspect Ratio:</label>
                                <select class="form-select" id="image-aspect-ratio" disabled>
                                    <option value="16:9" selected>16:9 (Landscape)</option>
                                    <option value="9:16">9:16 (Portrait)</option>
                                </select>
                            </div>
                            <div class="form-group mb-2">
                                <label for="image-video-model-select">Select Video Model:</label>
                                <select class="form-select" id="image-video-model-select" disabled>
                                    <option value="veo-3.0-fast-generate-preview" selected>Veo 3.0 Fast</option>
                                    <option value="veo-3.0-generate-preview">Veo 3.0 Standard</option>
                                </select>
                            </div>
                            <div class="form-group mb-2">
                                <label for="image-seed-input">Enter Seed:</label>
                                <input type="number" class="form-control" id="image-seed-input" value="42" disabled>
                            </div>
                            <button id="add-to-image-queue-btn" class="btn btn-primary w-100" disabled>Add to Queue</button>
                        </div>
                        <div class="col-md-8">
                            <h3>2. Generation Queue</h3>
                            <div id="image-video-queue" class="list-group mb-3" style="max-height: 400px; overflow-y: auto;">
                                <!-- Image prompts will be added here dynamically -->
                            </div>
                            <button id="run-parallel-image-generation-btn" class="btn btn-success w-100">Run Parallel Image Generation</button>
                        </div>
                    </div>
                    <div id="image-video-status-container" class="mt-4">
                        <!-- Image to video generation statuses will appear here -->
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-pane fade" id="settings" role="tabpanel" aria-labelledby="settings-tab">
                <div class="mt-4">
                    <h3>Configuration Settings</h3>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group mb-3">
                                <label for="project-id-input" class="form-label">Google Cloud Project ID</label>
                                <input type="text" class="form-control" id="project-id-input" placeholder="Enter your Project ID">
                            </div>
                            <div class="form-group mb-3">
                                <label for="gcs-bucket-input" class="form-label">GCS Bucket Name</label>
                                <input type="text" class="form-control" id="gcs-bucket-input" placeholder="Enter your GCS Bucket Name">
                            </div>
                            <button id="save-validate-btn" class="btn btn-primary">Save and Validate</button>
                            <div id="validation-status" class="mt-3"></div>
                        </div>
                        <div class="col-md-6">
                            <div id="usage-dashboard" style="display: none;">
                                <h4>Usage Dashboard</h4>
                                <div class="btn-group mb-3" role="group">
                                    <button type="button" class="btn btn-secondary report-range-btn" data-range="1d">Last 1 Day</button>
                                    <button type="button" class="btn btn-secondary report-range-btn" data-range="7d">Last 7 Days</button>
                                    <button type="button" class="btn btn-secondary report-range-btn" data-range="4w">Last 4 Weeks</button>
                                    <button type="button" class="btn btn-secondary report-range-btn" data-range="2m">Last 2 Months</button>
                                </div>
                                <pre id="usage-report"></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Image Editor Tab -->
            <div class="tab-pane fade" id="image-editor" role="tabpanel" aria-labelledby="editor-tab">
                <div class="mt-4">
                    <div class="row">
                        <div class="col-md-3">
                            <h3>Image Editor</h3>
                            <div class="p-3 border rounded mb-3">
                                <h5>Generate Image</h5>
                                <div class="form-group mb-2">
                                    <label for="editor-prompt" class="form-label">User Prompt</label>
                                    <textarea id="editor-prompt" class="form-control" rows="3"></textarea>
                                </div>
                                <div class="form-group mb-2">
                                    <label for="editor-negative-prompt" class="form-label">Negative Prompt</label>
                                    <textarea id="editor-negative-prompt" class="form-control" rows="2"></textarea>
                                </div>
                                <div class="form-group mb-2">
                                    <label for="editor-seed" class="form-label">Seed</label>
                                    <input type="number" class="form-control" id="editor-seed" value="42">
                                </div>
                                <div class="form-group mb-2">
                                    <label for="editor-aspect-ratio" class="form-label">Aspect Ratio</label>
                                    <select class="form-select" id="editor-aspect-ratio">
                                        <option value="16:9" selected>16:9</option>
                                        <option value="9:16">9:16</option>
                                        <option value="1:1">1:1</option>
                                        <option value="4:3">4:3</option>
                                        <option value="3:4">3:4</option>
                                    </select>
                                </div>
                                <button id="generate-editor-image-btn" class="btn btn-success w-100">Generate Image</button>
                            </div>
                            <hr>
                            <div class="form-group mb-3">
                                <label for="editor-image-upload" class="form-label">Or Upload Image</label>
                                <input type="file" class="form-control" id="editor-image-upload" accept="image/*">
                            </div>
                            <div class="form-group mb-3">
                                <label for="brush-color" class="form-label">Brush Color</label>
                                <input type="color" class="form-control form-control-color" id="brush-color" value="#FF0000">
                            </div>
                            <div class="form-group mb-3">
                                <label for="brush-size" class="form-label">Brush/Line Size</label>
                                <input type="range" class="form-range" id="brush-size" min="1" max="50" value="5">
                            </div>
                            <div class="form-group mb-3">
                                <label class="form-label">Tool</label>
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="editor-tool" id="tool-pen" autocomplete="off" value="pen" checked>
                                    <label class="btn btn-outline-primary" for="tool-pen">Pen</label>

                                    <input type="radio" class="btn-check" name="editor-tool" id="tool-arrow" autocomplete="off" value="arrow">
                                    <label class="btn btn-outline-primary" for="tool-arrow">Arrow</label>

                                    <input type="radio" class="btn-check" name="editor-tool" id="tool-box" autocomplete="off" value="box">
                                    <label class="btn btn-outline-primary" for="tool-box">Box</label>
                                </div>
                            </div>
                            <hr>
                            <div class="form-group mb-3">
                                <label for="text-input" class="form-label">Text</label>
                                <input type="text" class="form-control" id="text-input" placeholder="Enter text...">
                            </div>
                            <div class="form-group mb-3">
                                <label for="text-color" class="form-label">Text Color</label>
                                <input type="color" class="form-control form-control-color" id="text-color" value="#FFFFFF">
                            </div>
                            <div class="form-group mb-3">
                                <label for="font-size" class="form-label">Font Size</label>
                                <input type="range" class="form-range" id="font-size" min="10" max="100" value="30">
                            </div>
                            <button id="add-text-btn" class="btn btn-secondary w-100 mb-2">Add Text</button>
                            <button id="clear-edits-btn" class="btn btn-danger w-100 mb-3">Clear Edits</button>
                            <button id="send-to-video-tab-btn" class="btn btn-primary w-100" disabled>Use this Image for Video</button>
                        </div>
                        <div class="col-md-9 position-relative">
                            <canvas id="editor-canvas" class="border" style="width: 100%; height: auto;"></canvas>
                            <div id="custom-cursor" class="custom-cursor"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Crop Modal -->
    <div class="modal fade" id="cropModal" tabindex="-1" aria-labelledby="cropModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="cropModalLabel">Crop Image</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div>
                        <img id="image-to-crop" src="" style="max-width: 100%;">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="crop-and-save-btn">Crop and Add to Queue</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
